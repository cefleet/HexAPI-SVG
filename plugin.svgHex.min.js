var svgHex=function(){function newGrid(e,t){if(e){var r=Math.random();grids[r]={id:r};var i=_setupGrid(e,t);return grids[r].groups=i[1],grids[r].grid=i[0],grids[r]}return console.warn("You must specify a container for the SVG."),!1}function getGrid(e){return grids[e]}function getAllGrids(){return grids}function _setupGrid(e,t){var r=HexAPI.setup(t);if(t.hexList)for(var i in r.map)t.hexList.indexOf(i)<0&&delete r.map[i];"string"==typeof e&&(e=SVG(e));var n={default:e};return n.highlight=n.default.nested(),[r,n]}function drawHex(e,t,r){(r=r||gOptions).parent=r.parent||"default",e.groups.hasOwnProperty(r.parent)||(e.groups[r.parent]=e.groups.default.nested());for(var i,n=e.groups[r.parent],s=[],a=0;a<t.corners.length;a++)s.push([t.corners[a].x,t.corners[a].y]);if(r.animate){i=n.polygon([t.centerPoint.x,t.centerPoint.y]).fill(r.fill).stroke(r.stroke);var o=r.animate.ease||"-",h=r.animate.delay||0,g=r.animate.time||300;i.animate(g,o,h).plot(s)}else i=n.polygon(s).fill(r.fill).stroke(r.stroke);if(i.hex=t,i.grid=e,r.events)for(o in r.events)i.on(o,r.events[o]);return i}function highlightArea(e,t,r,i,n){i=i||{};var s=_idsToHex(e,t.hex.getHexesWithinDistance(r));return i.sequence?(i.range=r,sequences[i.sequence.type](e,t,i.sequence.delay,i,this)):highlightList(e,s,i),s}function _idsToHex(e,t){for(var r={},i=0;i<t.length;i++){var n=t[i].q+"."+t[i].r+"."+t[i].s;e.grid.map.hasOwnProperty(n)&&(r[n]=e.grid.map[n])}return r}function highlightList(e,t,r){(r=r||{}).parent=r.parent||"highlight",e.groups.hasOwnProperty(r.parent)||(e.groups[r.parent]=e.groups.default.nested()),r.reset?resetHexes(e,r.reset):r.noReset||resetHexes(e,r.parent);for(h in t)highlightHex(e,t[h],r)}function resetHexes(e,t){if(t){Array.isArray(t)||(t=[t]);for(var r=0;r<t.length;r++)e.groups.hasOwnProperty(t[r])&&e.groups[t[r]].clear()}else for(var i in e.groups)"default"!=i&&e.groups[i].clear()}function highlightHex(e,t,r){if(r=r||{},i=t,r.parent=r.parent||"highlight",e.groups.hasOwnProperty(r.parent)||(e.groups[r.parent]=e.groups.default.nested()),"default"!=r.parent&&e.groups[r.parent].front(),t instanceof HexAPI.Hex)var i=drawHex(e,t,r);if(r.fill=r.fill||{color:gOptions.highlight.color,opacity:1},r.fade){var n=r.fade.time||200,s=r.fade.ease||"-";i.animate(n,s,0).fill(r.fill)}else i.fill(r.fill);r.animate&&"string"==typeof r.animate&&animateHex(i,r.animate)}function drawHexes(e,t,r){r=r||gOptions,t=t||e.grid.map;for(h in t)drawHex(e,t[h],r)}function _createAnimString(e){eString="";for(var t=0;t<e.length;t++){var r=e[t];eString+=".animate("+r.time+',"'+r.ease+'",'+r.delay+")";for(var i=0;i<r.effects.length;i++)if("object"==typeof r.effects[i].value){eString+="."+r.effects[i].type+"({";for(v in r.effects[i].value)eString+=v+":"+r.effects[i].value[v];eString+="})"}else eString+="."+r.effects[i].type+"("+r.effects[i].value+")"}return eString}function animateHex(hexElem,animName,front){void 0===front&&(front=!0),front&&hexElem.front();var anim=anims[animName],eString="hexElem";eString+=_createAnimString(anim),eval(eString)}var grids={},grid=null,groups={},gOptions={stroke:{width:2,color:"#3E3E3E"},fill:{color:"#E3E3E3"},highlight:{color:"#F06"}},HexAPI=function(){var e=function(){var e=function(e,t,r){return{q:e,r:t,s:r}},t=function(e,t){return{x:e,y:t}},r=function(t,r){return e(t.q+r.q,t.r+r.r,t.s+r.s)},i=function(t,r){return e(t.q*r,t.r*r,t.s*r)},n=function(e){return d[e]},s=function(e){return p[e]},a=function(e,t,r,i,n,s,a,o,h){return{f0:e,f1:t,f2:r,f3:i,b0:n,b1:s,b2:a,b3:o,start_angle:h}},o=function(t){var r=Math.trunc(Math.round(t.q)),i=Math.trunc(Math.round(t.r)),n=Math.trunc(Math.round(t.s)),s=Math.abs(r-t.q),a=Math.abs(i-t.r),o=Math.abs(n-t.s);return s>a&&s>o?r=-i-n:a>o?i=-r-n:n=-r-i,e(r,i,n)},h=function(e,r){var i=e.orientation,n=e.hexSize,s=2*Math.PI*(r+i.start_angle)/6;return t(n.x*Math.cos(s),n.y*Math.sin(s))},g=function(e,t){return r(e,n(t))},f=function(e,r){var i=e.orientation,n=e.hexSize,s=e.origin,a=(i.f0*r.q+i.f1*r.r)*n.x,o=(i.f2*r.q+i.f3*r.r)*n.y;return t(a+s.x,o+s.y)},u=function(e,t){for(var s=[],a=r(e,i(n(4),t)),o=0;6>o;o++)for(var h=0;t>h;h++)s.push(a),a=g(a,o);return s},c={POINTY:a(Math.sqrt(3),Math.sqrt(3)/2,0,1.5,Math.sqrt(3)/3,-1/3,0,2/3,.5),FLAT:a(1.5,0,Math.sqrt(3)/2,Math.sqrt(3),2/3,0,-1/3,Math.sqrt(3)/3,0)},d=[e(1,0,-1),e(1,-1,0),e(0,-1,1),e(-1,0,1),e(-1,1,0),e(0,1,-1)],p=[e(2,-1,-1),e(1,-2,1),e(-1,-1,2),e(-2,1,1),e(-1,2,-1),e(1,1,-2)];return{distanceBetween:function(e,t){return(Math.abs(e.q-t.q)+Math.abs(e.q+e.r-t.q-t.r)+Math.abs(e.r-t.r))/2},neighborAtDirection:g,neighborsAtDiagonal:function(e,t){var i=s(t);return r(e,i)},createLayout:function(e,t,r){return r="pointy"==r?c.POINTY:c.FLAT,{orientation:r,hexSize:e,origin:t}},centerOfHex:f,cornersOfHex:function(e,r){for(var i=[],n=f(e,r),s=1;6>=s;s++){l=s,6===l&&(l=0);var a=h(e,s);i.push(t(n.x+a.x,n.y+a.y))}return i},hexAtPoint:function(r,i){var n=r.orientation,s=r.hexSize,a=r.origin,h=t((i.x-a.x)/s.x,(i.y-a.y)/s.y),g=n.b0*h.x+n.b1*h.y,f=n.b2*h.x+n.b3*h.y,u=e(g,f,-g-f);return o(u)},getHexesWithinDistance:function(e,t){for(var r=[{q:e.q,r:e.r,s:e.s}],i=1;t>=i;i++)for(var n=u(e,i),s=0;s<n.length;s++)r.push(n[s]);return r},getHexesAtDistance:u,checkIfLinesIntersect:function(e,t){var r,i,n,s,a,o,h,g,f,u,c,l,d,p=!1;return r=e[0].x,i=e[0].y,n=e[1].x,s=e[1].y,a=t[0].x,o=t[0].y,h=t[1].x,g=t[1].y,0==(f=(g-o)*(n-r)-(h-a)*(s-i))?p:(u=i-o,c=r-a,l=(h-a)*u-(g-o)*c,d=(n-r)*u-(s-i)*c,u=l/f,c=d/f,u>0&&1>u&&c>0&&1>c&&(p=!0),p)}}}(),t=function(e){this._init(e)};t.prototype={_init:function(e){this.engine=e.engine,e=e||{},this.hexSize=e.hexSize||{x:30,y:30},this.origion=e.origion||{x:0,y:0},this.orientation=e.orientation||"pointy",this.layout=this.engine.createLayout(this.hexSize,this.origion,this.orientation),this.rows=e.rows||30,this.cols=e.cols||20,this._createMap()},getHexList:function(){return Object.keys(this.map)},getHexAtPoint:function(e){return this.engine.hexAtPoint(this.layout,e)},_createMap:function(){this.map={},"pointy"==this.orientation?this._makePointyMap():this._makeFlatMap()},_makePointyMap:function(){for(r=0;r<this.rows;r++){var e=Math.floor(r/2);for(q=-e;q<this.cols-e;q++){var t=new HexAPI.Hex({q:q,r:r,s:-q-r,grid:this});this.map[t.id]=t}}},_makeFlatMap:function(){for(q=0;q<this.cols;q++){var e=Math.floor(q/2);for(r=-e;r<this.rows-e;r++){var t=new HexAPI.Hex({q:q,r:r,s:-q-r,grid:this});this.map[t.id]=t}}}};var i=function(e){this._init(e)};return i.prototype={_init:function(e){this.grid=e.grid,this.engine=this.grid.engine,e=e||{},this.q=e.q||0,this.r=e.r||0,this.s=e.s||0,this.id=this.q+"."+this.r+"."+this.s,this._setCenter(),this._setCorners(),this._setEdges(),this._setNeighbors(),this._setDiagonalNeighbors()},getNeighborAt:function(e){return this.neighbors[e]},getDistanceTo:function(e){return this.engine.distanceBetween(this,e)},getHexesWithinDistance:function(e){return this.engine.getHexesWithinDistance(this,e)},getHexesAtDistance:function(e){return this.engine.getHexesAtDistance(this,e)},makeHexLineTo:function(e){return this.engine._defineLineBetweenHexes(this,e)},makeStraightLineTo:function(e){return!!e&&[this.centerPoint,e.centerPoint]},getPathTo:function(e,t,r){for(var i=this._aStarGetPathTo(e,t,r),n=[],s=0;s<i.length;s++)n.push(this.grid.map[i[s].id]);return n},_aStarGetPathTo:function(e,t,r){var i;this._astarGridSetup(t,e);var n=this._aStarGrid;for(i=0;i<n.length;i++)n[i].id===this.id&&(start=n[i]),n[i].id===e.id&&(end=n[i]);var s=[];for(s.push(start),this._astarHeuristic;s.length>0;){var a=0;for(i=0;i<s.length;i++)s[i].f<s[a].f&&(a=i);var o=s[a];if(o==end){for(var h=o,g=[];h.parent;)g.push(h),h=h.parent;return g.reverse()}for(s.splice(a,1),o.closed=!0,i=0;i<o.neighbors.length;i++){var f=this._getAstarGridItemFromId(o.neighbors[i]);if(f&&!f.closed&&!f.isObstacle){var u=o.g+1,c=!1;f.visited?u<f.g&&(c=!0):(c=!0,f.h=this._astarHeuristic(f,end),f.visited=!0,s.push(f)),c&&(f.parent=o,f.g=u,f.f=f.g+f.h,f.debug="F: "+f.f+"<br />G: "+f.g+"<br />H: "+f.h)}}}return[]},_getAstarGridItemFromId:function(e){for(var t=0;t<this._aStarGrid.length;t++)if(this._aStarGrid[t].id===e)return this._aStarGrid[t]},_astarGridSetup:function(e,t){var r=[];for(var i in this.grid.map){var n=this._astartGridifyFromId(i);if(e)for(var s=0;s<e.length;s++)e[s].q+"."+e[s].r+"."+e[s].s===n.id&&t.id!==n.id&&(n.isObstacle=!0);r.push(n)}this._aStarGrid=r},_astartGridifyFromId:function(e){var t={};return t.id=e,t.neighbors=this.grid.map[e].neighbors,t.q=this.grid.map[e].q,t.r=this.grid.map[e].r,t.s=this.grid.map[e].s,t.f=0,t.g=0,t.h=0,t.debug="",t.parent=null,t.isObstacle=!1,t},_astarHeuristic:function(e,t){return this.engine.distanceBetween(e,t)},_setCorners:function(){this.corners=this.engine.cornersOfHex(this.grid.layout,this)},_setEdges:function(){this.edges=[],this.edges.push([this.corners[5],this.corners[0]]);for(var e=4;e>=0;e--){var t=e+1;this.edges.push([this.corners[t],this.corners[e]])}},_setCenter:function(){this.centerPoint=this.engine.centerOfHex(this.grid.layout,this)},_setNeighbors:function(){this.neighbors=[];for(var e=0;6>e;e++){var t=this.engine.neighborAtDirection(this,e);this.neighbors.push(t.q+"."+t.r+"."+t.s)}},_setDiagonalNeighbors:function(){this.diagonalNeighbors=[];for(var e=0;6>e;e++){var t=this.engine.neighborsAtDiagonal(this,e);this.diagonalNeighbors.push(t.q+"."+t.r+"."+t.s)}},_checkIfLineCrosses:function(e){for(var t=!1,r=0;r<this.edges.length;r++)if(this.edges[r]&&this.engine.checkIfLinesIntersect(e,this.edges[r])){t=!0;break}return t}},{setup:function(r){return r=r||{},r.engine=e,new t(r)},Engine:e,Grid:t,Hex:i}}(),anims={bounce:[{time:75,ease:">",delay:0,effects:[{type:"transform",value:{scale:1.6}}]},{time:200,ease:"<",delay:0,effects:[{type:"transform",value:{scale:.8}}]},{time:100,ease:"<",delay:0,effects:[{type:"transform",value:{scale:1}}]}],spin:[{time:400,ease:"-",delay:0,effects:[{type:"rotate",value:180},{type:"transform",value:{scale:1.2}}]},{time:400,ease:"-",delay:0,effects:[{type:"rotate",value:0},{type:"transform",value:{scale:1}}]}]},sequences={ringOut:function(e,t,r,i){(i=i||{}).parent&&e.groups.hasOwnProperty(i.parent)&&resetHexes(i.parent);var n=0;highlightList(e,[t.hex],i);var s=window.setInterval(function(){var r=t.hex.getHexesAtDistance(n),a=_idsToHex(e,r);i.noReset=!0,i.reset=null,highlightList(e,a,i),++n>i.range&&clearInterval(s)},r)}};return{newGrid:newGrid,getGrid:getGrid,getAllGrids:getAllGrids,drawHex:drawHex,drawHexes:drawHexes,animateHex:animateHex,highlightHex:highlightHex,highlightList:highlightList,highlightArea:highlightArea}}();classes&&(classes.svgHex=svgHex);
//# sourceMappingURL=plugin.svgHex.min.map